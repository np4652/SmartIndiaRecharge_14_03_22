function DeviceRegisterOpen(){$.post("/device-register",n=>{mdlA.id="mdlMsgbx",mdlA.content=n,mdlA.alert(mdlA.size.large),$("#btnClose").click(()=>mdlA.dispose())})}function DeviceRegister(n){var t=$("#saveDevice").id;$("#deviceSearching").html("Searching for Device...");$("#hfSelectedDevice").val(n);CaptureAvdm(t,"register")}function discoverAvdm(){var i,t,u,n,f,e,r;GetCustomDomName="127.0.0.1";$("#txtWadh").val("");$("#ContentPlaceHolder1_txtDeviceInfo").val("");$("#txtPidOptions").val("");$("#ContentPlaceHolder1_txtPidData").val("");i=0;t="http://"+GetCustomDomName+":";try{u=window.location.href;u.indexOf("https")>=0&&(t="https://"+GetCustomDomName+":")}catch(o){console.log(o)}for(url="",i=0,n=11100;n<=11105;n++)t==="https://"+GetCustomDomName+":"&&OldPort===!0&&(n="8005"),$("#lblStatus1").text("Discovering RD service on port : "+n.toString()),f="RDSERVICE",$.support.cors=!0,r=!1,$.ajax({type:f,"async":!1,crossDomain:!0,url:t+n.toString(),contentType:"text/xml; charset=utf-8",processData:!1,cache:!1,success:function(u){r=!0;e={httpStaus:r,data:u};finalUrl=t+n.toString();var f=$.parseXML(u),s=$(f).find("RDService").attr("status"),o=$(f).find("RDService").attr("info");MethodCapture=t.replace("http:/","")+n.toString()+"/capture";RegExp("\\bMantra\\b").test(o)===!0&&($(f).find("Interface").eq(0).attr("path")==="/rd/capture"&&(MethodCapture=$(f).find("Interface").eq(0).attr("path")),$(f).find("Interface").eq(1).attr("path")==="/rd/capture"&&(MethodCapture=$(f).find("Interface").eq(1).attr("path")),$(f).find("Interface").eq(0).attr("path")==="/rd/info"&&(MethodInfo=$(f).find("Interface").eq(0).attr("path")),$(f).find("Interface").eq(1).attr("path")==="/rd/info"&&(MethodInfo=$(f).find("Interface").eq(1).attr("path")),$("#ddlAVDM").append("<option value="+n.toString()+">("+s+"-"+n.toString()+")"+o+"<\/option>"),i=1,$("#deviceSearching").html("Place finger on device"))},error:function(){n==="8005"&&OldPort===!0&&(OldPort=!1,n="11099")}}),i===1;return i===0?$("#deviceSearching").html("Connection failed Please try again."):$("#deviceSearching").html("Place finger on device"),e}function Demo(){var n="",t="",i="";GetPI()===!0?n="<Pi "+GetPIString+" />":GetPIString="";GetPA()===!0?t="<Pa "+GetPAString+" />":GetPAString="";GetPFA()===!0?i="<Pfa "+GetPFAString+" />":GetPFAString="";DemoFinalString=GetPI()===!1&&GetPA()===!1&&GetPFA()===!1?"":"<Demo>"+n+" "+t+" "+i+" <\/Demo>"}function GetPI(){var n=!1;return GetPIString="",$("#drpMatchValuePI").val()>0&&n&&(n=!0,GetPIString+=' mv="'+$("#drpMatchValuePI").val()+'"'),$("#rdExactPI").is(":checked")&&n?(n=!0,GetPIString+=' ms="E"'):$("#rdPartialPI").is(":checked")&&n?(n=!0,GetPIString+=' ms="P"'):$("#rdFuzzyPI").is(":checked")&&n&&(n=!0,GetPIString+=' ms="F"'),$("#txtLocalNamePI").val().length>0&&(n=!0,GetPIString+=' lname="'+$("#txtLocalNamePI").val()+'"'),$("#txtLocalNamePI").val().length>0&&$("#drpLocalMatchValuePI").val()>0&&(n=!0,GetPIString+=' lmv="'+$("#drpLocalMatchValuePI").val()+'"'),$("#drpGender").val()==="MALE"?(n=!0,GetPIString+=' gender="M"'):$("#drpGender").val()==="FEMALE"?(n=!0,GetPIString+=' gender="F"'):$("#drpGender").val()==="TRANSGENDER"&&(n=!0,GetPIString+=' gender="T"'),$("#txtDOB").val().length>0&&(n=!0,GetPIString+=' dob="'+$("#txtDOB").val()+'"'),$("#drpDOBType").val()!=="0"&&(n=!0,GetPIString+=' dobt="'+$("#drpDOBType").val()+'"'),$("#txtAge").val().length&&(n=!0,GetPIString+=' age="'+$("#txtAge").val()+'"'),($("#txtPhone").val().length>0||$("#txtEmail").val().length>0)&&(n=!0,GetPIString+=' phone="'+$("#txtPhone").val()+'"'),$("#txtEmail").val().length>0&&(n=!0,GetPIString+=' email="'+$("#txtEmail").val()+'"'),n}function GetPA(){var n=!1;return GetPAString="",$("#txtCareOf").val().length>0&&(n=!0,GetPAString+='co="'+$("#txtCareOf").val()+'"'),$("#txtLandMark").val().length>0&&(n=!0,GetPAString+=' lm="'+$("#txtLandMark").val()+'"'),$("#txtLocality").val().length>0&&(n=!0,GetPAString+=' loc="'+$("#txtLocality").val()+'"'),$("#txtCity").val().length>0&&(n=!0,GetPAString+=' vtc="'+$("#txtCity").val()+'"'),$("#txtDist").val().length>0&&(n=!0,GetPAString+=' dist="'+$("#txtDist").val()+'"'),$("#txtPinCode").val().length>0&&(n=!0,GetPAString+=' pc="'+$("#txtPinCode").val()+'"'),$("#txtBuilding").val().length>0&&(n=!0,GetPAString+=' house="'+$("#txtBuilding").val()+'"'),$("#txtStreet").val().length>0&&(n=!0,GetPAString+=' street="'+$("#txtStreet").val()+'"'),$("#txtPOName").val().length>0&&(n=!0,GetPAString+=' po="'+$("#txtPOName").val()+'"'),$("#txtSubDist").val().length>0&&(n=!0,GetPAString+=' subdist="'+$("#txtSubDist").val()+'"'),$("#txtState").val().length>0&&(n=!0,GetPAString+=' state="'+$("#txtState").val()+'"'),$("#rdMatchStrategyPA").is(":checked")&&n&&(n=!0,GetPAString+=' ms="E"'),n}function GetPFA(){var n=!1;return GetPFAString="",$("#txtAddressValue").val().length>0&&(n=!0,GetPFAString+='av="'+$("#txtAddressValue").val()+'"'),$("#drpMatchValuePFA").val()>0&&$("#txtAddressValue").val().length>0&&(n=!0,GetPFAString+=' mv="'+$("#drpMatchValuePFA").val()+'"'),$("#rdExactPFA").is(":checked")&&n?(n=!0,GetPFAString+=' ms="E"'):$("#rdPartialPFA").is(":checked")&&n?(n=!0,GetPFAString+=' ms="P"'):$("#rdFuzzyPFA").is(":checked")&&n&&(n=!0,GetPFAString+=' ms="F"'),$("#txtLocalAddress").val().length>0&&(n=!0,GetPFAString+=' lav="'+$("#txtLocalAddress").val()+'"'),$("#drpLocalMatchValue").val()>0&&$("#txtLocalAddress").val().length>0&&(n=!0,GetPFAString+=' lmv="'+$("#drpLocalMatchValue").val()+'"'),n}function CaptureAvdm(n,t){var u,f,e,o,s,i,h,r;if($("#hidIsLoc").val()!=="-1"&&$("#hidIsLoc").val()!=="1")return an.title="Location Error! ",an.content="Please allow location",an.alert(an.type.failed),LocationUpdate(),!1;if(GetCustomDomName="127.0.0.1",$("#AadharHelp").addClass("d-none"),$("#AmountHelp").addClass("d-none"),t!=="register"){if($("#txtAadhar").val().length<12){$("#AadharHelp").removeClass("d-none");return}if($("#ddlBank option").eq(0).prop("selected")){alert("Please select bank");return}if(t==="with"&&$("#txtAmount").val()===""){$("#AmountHelp").removeClass("d-none");return}}u="";f="";Demo();$("#txtWadh").val()!==""&&(u=' wadh="'+$("#txtWadh").val()+'"');$("#txtotp").val()!==""&&(f=' otp="'+$("#txtotp").val()+'"');e='<?xml version="1.0"?> <PidOptions ver="1.0"> <Opts fCount="'+$("#Fcount").val()+'" fType="'+$("#Ftype").val()+'" iCount="'+$("#Icount").val()+'" pCount="'+$("#Pcount").val()+'" pgCount="'+$("#pgCount").val()+'"'+f+' format="'+$("#Dtype").val()+'"   pidVer="'+$("#Pidver").val()+'" timeout="'+$("#Timeout").val()+'" pTimeout="'+$("#pTimeout").val()+'"'+u+' posh="UNKNOWN" env="'+$("#Env").val()+'" /> '+DemoFinalString+'<CustOpts><Param name="mantrakey" value="'+$("#txtCK").val()+'" /><\/CustOpts> <\/PidOptions>';finalUrl="http://"+GetCustomDomName+":"+$("#ContentPlaceHolder1_ddlAVDM").val();try{o=window.location.href;o.indexOf("https")>=0&&(finalUrl="https://"+GetCustomDomName+":"+$("#ContentPlaceHolder1_ddlAVDM").val())}catch(c){console.log(c)}return s="CAPTURE",i=$("#hfSelectedDevice").val(),$.support.cors=!0,r=!1,$("#"+n).attr("disabled","disabled"),btnLdr.Start($("#"+n),"Requesting..."),setTimeout(function(){discoverAvdm();$.ajax({type:s,"async":!1,crossDomain:!0,url:finalUrl+MethodCapture,data:e,contentType:"text/xml; charset=utf-8",processData:!1,success:function(u){var c,s,l,a;if(i=1,i===1)if($(u)[2]){var f=$(u)[2],o=$(f).find("Resp").attr("errInfo"),h=$(f).find("Resp").attr("errCode");if($("#deviceSearching").html(o),h==="0")PidData=u;else{alert(o);return}}else{$("#deviceSearching").html("Device Not found");return}if(i===2&&$(u)[0])if(f=$(u)[0],o=$(f).find("Resp").attr("errInfo"),h=$(f).find("Resp").attr("errCode"),$("#deviceSearching").html(o),h==="0")PidData=f,u=$(f)[0].documentElement.outerHTML;else{alert(o);return}if(r=!0,s={httpStaus:r,data:u},$("#ContentPlaceHolder1_txtPidData").val(u),$("#txtPidOptions").val(e),f=$.parseXML(u),c=$.parseXML(u),o=$(c).find("Resp").attr("errInfo"),t==="register"){$("#deviceSearching").html("");$("#deviceInfo").show();$("#deviceList").hide();s=$.parseXML(u);s||(s=u);l=$(s).find("DeviceInfo").attr("dpId");a=$(s).find("Skey").attr("ci");$("#deviceModel").html(l);$("#deviceID").html(a);$("#LocalDeviceID").val(i);return}t==="bal"&&($("#"+n).html("Check Balance"),$("#"+n).removeAttr("disabled"),btnLdr.Stop($("#"+n)),preloader.remove(),CheckBalance(u));t==="with"?($("#"+n).removeAttr("disabled"),btnLdr.Stop($("#"+n)),preloader.remove(),Withdrawl(u)):($("#"+n).html("Check Balance"),$("#"+n).removeAttr("disabled"));o==="Success"?($("#ContentPlaceHolder1_lblFlag").val(t),$("#static").modal("show")):alert(o)},error:function(i,u,f){t==="bal"?($("#"+n).html("Balance Enquiry"),$("#"+n).removeAttr("disabled"),$("#"+n).attr("class","btn btn-primary btn-round")):($("#"+n).html("Withdrawal"),$("#"+n).removeAttr("disabled"),$("#"+n).attr("class","btn btn-primary btn-round"));alert(f);h={httpStaus:r,err:getHttpError(i)}},complete:function(){btnLdr.Stop($("#"+n));preloader.remove()}});t==="bal"?$("#"+n).removeAttr("disabled"):$("#"+n).removeAttr("disabled")},100),t==="bal"?$("#"+n).removeAttr("disabled"):$("#"+n).removeAttr("disabled"),h}function Withdrawl(n){let i=$("#hidLat").val(),r=$("#hidLong").val();var u={PidData:n,aadhar:$("#txtAadhar").val(),bank:$("#ddlBank").val(),t,amount:$("#txtAmount").val(),_lat:i,_long:r};$.post("/AepsWithdraw",u).done(n=>{var t=`<div class="row text-center">
                    <div class="col-md-12">
                        <button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h5 class="text-info">Transaction Info</h5><hr />
                    </div>
                    <div class="col-md-12">
                        <label class="${n.status===3?`h5 text-danger`:`text-success`}">${getKeyByValue(StatusText,n.status)}</label >
                        <div class="form-group">
                            <label>${n.msg}</label>
                        </div>
                        ${n.statuscode===1?`<div class="form-group">
                                                            <label>Bank Balance : ${n.balance}</label>
                                                         </div>
                                                     <div class="form-group">
                                                        <label>Transaction ID : ${n.transactionID}</label>
                                                     </div>
                                                     <div class="form-group">
                                                        <label>Live ID : ${n.liveID}</label>
                                                     </div>`:``}
                    </div>
                </div>`;mdlA.id="mdlMsgbx";mdlA.content=t;mdlA.options.backdrop="static";mdlA.alert(mdlA.size.default);$("button.close").click(()=>mdlA.dispose())})}function SaveDevice(){var n={DeviceName:$("#deviceID").html(),ID:$("#LocalDeviceID").val()};$.post("/device-save",n,n=>{console.log(n),n.status&&($("#deviceSaved").show(),$("#deviceInfo").hide(),$("#deviceList").hide(),setTimeout(function(){$("#mdlMsgbx").modal("hide")},5e3))})}var StatusText={PENDING:1,SUCCESS:2,FAILED:3},LocationUpdate,CheckBalance;(()=>{$("#ddlBank").unbind().change(function(){if($(this).val()==="0")$("#opImg img").attr("src","/Image/BankLogo/0.png");else{var n=$("#ddlBank option:selected").text();$("#opImg img").attr("src","/Image/BankLogo/"+n+".png")}})})();LocationUpdate=function(){$("#hidIsLoc").val("-1");navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(n){$("#hidLat").val(n.coords.latitude.toFixed(4));$("#hidLong").val(n.coords.longitude.toFixed(4))},function(n){$("#hidIsLoc").val(n.code)})};var GetCustomDomName="127.0.0.1",GetPIString="",GetPAString="",GetPFAString="",DemoFinalString="";CheckBalance=function(n){let i=$("#hidLat").val(),r=$("#hidLong").val();$.post("/getAepsBalance",{PidData:n,aadhar:$("#txtAadhar").val(),bank:$("#ddlBank").val(),t,_lat:i,_long:r},function(n){var t=`<div class="row">
            <div class="col-md-12">
                <button type="button" class="close" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
                <h5 class="text-info">Balance Info</h3>
                <hr />
            </div>
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="form-group">
                    <label class="${n.statuscode===-1?`text-danger h4`:`text-success d-none`}"><i class="fas fa-info-circle"></i> ${n.msg} </label>
                </div>
        ${n.statuscode===1?`<div class="row form-group">
                         <div class="col-sm-5">
                             <label>Available Balance</label>
                         </div>
                         <div class="col-sm-7">
                           <span style="font-size:17px"><i class="fas fa-rupee-sign text-success"></i> ${n.balance} </span>
                         </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-sm-5">
                                <label>Bank RRN</label>
                            </div>
                            <div class="col-sm-7">
                                ${n.bankRRN===null?"":n.bankRRN}
                            </div>
                        </div>
                      </div>
                   </div>`:``}`;mdlA.id="mdlMsgbx";mdlA.content=t;mdlA.options.backdrop="static";mdlA.alert(mdlA.size.default);$("button.close").click(function(){mdlA.dispose()})})};