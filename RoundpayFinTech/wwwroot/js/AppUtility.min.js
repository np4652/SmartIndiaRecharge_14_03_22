"use strict";var ChangePass=function(n){preloader.load();$.post("/Change-Password",{IsMandate:n},function(t){resultReload(t);$("#"+an.id).remove();mdlA.id="myalert";mdlA.content=t;mdlA.options.backdrop="static";n===!0&&(mdlA.options.keyboard=!1);mdlA.alert(mdlA.size.small);$("button.close span,#mdlCancel").click(()=>mdlA.dispose());$("#btnChangePass").click(function(){let i=$validator,t={oldp:$("#txtOldPassword"),newp:$("#txtNewPassword"),confirmp:$("#txtConfirmPassword")},n={oldp:t.oldp.val().trim()==="",newp:t.newp.val().trim()==="",confirmp:t.confirmp.val().trim()==="",samep:t.newp.val().trim()===t.oldp.val().trim(),notsameconfirm:t.newp.val().trim()!==t.confirmp.val().trim()};if((i.showErrorFor(t.oldp,"Enter Old Password",n.oldp),i.showErrorFor(t.newp,"Enter New Password",n.newp),i.showErrorFor(t.confirmp,"Enter Confirm Password",n.confirmp),n.err=n.oldp||n.newp||n.confirmp,n.err)||(i.showErrorFor(t.newp,"New Password Cannot Be Same As Old Password",n.samep),n.err=n.samep,n.err)||(i.showErrorFor(t.confirmp,"Confirm Password Do Not Match",n.notsameconfirm),n.err=n.notsameconfirm,n.err))return!1;var r={UserId:"",OldPassword:t.oldp.val().trim(),NewPassword:t.newp.val().trim()};$.ajax({type:"POST",url:"/ChangePassword",dataType:"json",contentType:"application/json",data:JSON.stringify(r),success:function(n){resultReload(n);an.title=n.statuscode===an.type.success?"Well done":"Oops";an.content=n.msg;an.alert(n.statuscode);n.statuscode===an.type.success&&mdlA.dispose()},error:function(n,t){an.title="Oops! Error";an.content=n.status===404?"Requested path not find":n.status===0?"Internet is not connected":"Server error";an.alert(an.type.failed);t==="parsererror"&&reload()},complete:()=>btnLdr.Stop(t.btn)})})}).fail(n=>{an.title="Oops",an.content=n.status===0?"Internet Connection was broken":"Server error",an.alert(an.type.failed)}).always(()=>preloader.remove())},ChangePin=function(n){preloader.load();$.post("/Change-Pin",{IsMandate:n},function(t){resultReload(t);$("#"+an.id).remove();mdlA.id="myalert";mdlA.content=t;mdlA.options.backdrop="static";n===!0&&(mdlA.options.keyboard=!1);mdlA.alert(mdlA.size.small);$("button.close span,#mdlCancel").click(()=>mdlA.dispose());$("#btnChangePass").click(function(){var i=$validator,t={oldp:$("#txtOldPassword"),newp:$("#txtNewPassword"),confirmp:$("#txtConfirmPassword")},n={oldp:t.oldp.val().trim()==="",newp:t.newp.val().trim()==="",confirmp:t.confirmp.val().trim()==="",samep:t.newp.val().trim()===t.oldp.val().trim(),notsameconfirm:t.newp.val().trim()!==t.confirmp.val().trim()},r;if((i.showErrorFor(t.oldp,"Enter Password",n.oldp),i.showErrorFor(t.newp,"Enter New Pin",n.newp),i.showErrorFor(t.confirmp,"Enter Confirm Pin",n.confirmp),n.err=n.oldp||n.newp||n.confirmp,n.err)||(i.showErrorFor(t.newp,"New Pin Cannot Be Same As Old Password",n.samep),n.err=n.samep,n.err)||(i.showErrorFor(t.confirmp,"Confirm Pin Do Not Match",n.notsameconfirm),n.err=n.notsameconfirm,n.err))return!1;r={UserId:"",OldPassword:t.oldp.val().trim(),NewPassword:t.newp.val().trim()};$.ajax({type:"POST",url:"/ChangePin",dataType:"json",contentType:"application/json",data:JSON.stringify(r),success:function(n){resultReload(n);an.title=n.statuscode===an.type.success?"Well done":"Oops";an.content=n.msg;an.alert(n.statuscode);n.statuscode===an.type.success&&mdlA.dispose()},error:function(n,t){an.title="Oops! Error";an.content=n.status===404?"Requested path not find":n.status===0?"Internet is not connected":"Server error";an.alert(an.type.failed);t==="parsererror"&&reload()},complete:()=>btnLdr.Stop(t.btn)})})}).fail(n=>{an.title="Oops",an.content=n.status===0?"Internet Connection was broken":"Server error",an.alert(an.type.failed)}).always(()=>preloader.remove())},recentLoginActivity=()=>{$.post("/recent-login-activity",{TopRow:100,outputInjson:!0},function(n){let i=`<div class="table-responsive"><table class="table" id="recentLoginActivity">
                        <thead><tr><th>#</th><th>UserId</th><th>IP</th><th>Remark</th><th>Date</th><th>Longitude</th><th>Latitude</th><th></th></tr><thead>
                        <tbody>{{tr}}</tbody></table></div>`,t="";for(let i=0;i<n.length;i++)t=t+`<tr>
                            <td>${i+1} ${n[i].isActive?'<div class="led-green led-sm float-right">':""}</td>
                            <td>${n[i].loginMobile!==""?n[i].loginMobile:n[i].prefix+n[i].loginID}</td>
                            <td>${n[i].requestIP}</td>
                            <td>${n[i].commonStr}</td>
                            <td>${n[i].commonStr2}</td>
                            <td>${n[i].longitude}</td>
                            <td>${n[i].latitude}</td>
                            <td>${n[i].latitude!==0&&n[i].longitude!==0?'<a href="https://www.google.com/maps/@'+n[i].latitude+","+n[i].longitude+',15z" target="_blank"><i class="fas fa-map text-info"><\/i><\/a>':""} </td>
                       </tr>`;mdlA.title="Recent Login Activity";mdlA.id="recentLoginActivityWin";mdlA.content=i.replace("{{tr}}",t);mdlA.options.backdrop="static";mdlA.modal(mdlA.size.xlarge);$("#recentLoginActivity").fixTableHeader()}).fail(n=>{an.title="Oops",an.content=n.status===0?"Internet Connection was broken":"Server error",an.alert(an.type.failed)}).always(()=>preloader.remove())},viewBrand=()=>{$.post("/Brand").done(n=>{mdlA.id="brandView",mdlA.content=n,mdlA.title="Brand",mdlA.modal(mdlA.size.default)}).fail(n=>{an.title="Oops",an.content=n.status===0?"Internet Connection was broken":"Server error",an.alert(an.type.failed)})},showEmailAndSocial=(()=>{var n=new Date,t=n.getFullYear()+""+(n.getMonth()+1)+""+n.getDate(),i=localStorage.getItem("SAlertTime",t);t!==i&&$.post("/_ShowSocialPopup").done(n=>{n===!1?console.log(n):(mdlA.id="ShowSocialPopup",mdlA.title="",mdlA.headerClass="h3 text-danger text-center text-monospace",mdlA.content=n,mdlA.modal(mdlA.size.default,()=>{localStorage.setItem("SAlertTime",t)}))})})(()=>{$.ajax({type:"POST",url:"/LoginInfo",dataType:"json",contentType:"application/json",success:function(n){n.name===undefined?reload():(setInfo(n),$("body").removeAttr("class"))},error:function(n,t){an.title="Oops! Error";an.content=n.status===404?"Requested path not find":n.status===0?"Internet is not connected":"Server error";an.alert(an.type.failed);t==="parsererror"&&reload()}}),$.post("/mybal").done(n=>{if(n.isShowLBA===!0){var t=`<div class="col-md-12">
                                    <div class="col-md-12 text-center">
                                        <img src="/Image/iconMsg/9.png">
                                        <div class="">You Have Low Balance</div>
                    <div><small>Your Current Balance : ${n.balance}</small></div>
                    <button class="btn btn-outline-success btn-lg" id="btnRedirectToFund">Fund Request</button>
                    ${n.isAddMoneyEnable?`<button class="btn btn-outline-info btn-lg" id="btnRedirectToAddMoney">Add Money</button>`:`<span></span>`}
                    </div>`;mdlA.id="lowBalanceAlert";mdlA.title="Low Balance Alert";mdlA.headerClass="h3 text-danger text-center text-monospace";mdlA.content=t;mdlA.modal(mdlA.size.large);$("#btnRedirectToFund").click(()=>{sessionStorage.setItem("IsAlert",1),window.location.href="/fund-request"});$("#btnRedirectToAddMoney").click(()=>{sessionStorage.setItem("IsAlert",1),window.location.href="/addmoney"})}else showEmailAndSocial();$(".custom.bal").html(`<i class="fas fa-wallet text-warning"></i> ${n.sb}`);n.isP?ChangePass(!0):n.isPN&&ChangePin(!0)}).fail(n=>{an.title="Oops",an.content=n.status===0?"Internet Connection was broken":"Server error",an.alert(an.type.failed)}),$.post("/IsVendor").done(n=>{n.statuscode===an.type.success&&n.commonBool&&$(`ul.navbar-nav`).append(`<li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="dwnShopping" data-toggle="dropdown">Shopping</a>
                        <div class="dropdown-menu" area-labelledby="dwnShopping">
                            <a href="javascript:viewBrand()" class="dropdown-item">Brand</a>
                            <a href="/AddProduct" class="dropdown-item">Add Product</a>
                            <a href="/AllProduct" class="dropdown-item">All Product</a>
                            <a href="/shopping/OrderList" class="dropdown-item">Orders</a>
                            <a href="/shopping/OrderReport" class="dropdown-item">Orders Report</a>
                        </div>
                    </li>`)})})(),closeNotification=(n,t,i,r=false)=>{$.post("/CloseNotification",{id:n,userID:t,EntryDate:i}).done(t=>{t.statuscode===1&&(r||($(`.notification-${n}`).remove(),$("div.notification").length===0?$(".markRead").remove():""))})};(n=>{if($$IsWebNotify=="True"){n.loadNotification=n.loadNotification||{};var t,i,r=!1;n.loadNotification=u=>{n.post("/WebNotification",{IsShowAll:u}).done(f=>{if(f.isWebNotification)if(u===!1?t=f.notification:i=f.notification,u===!1){if(n("#IconNotification").length===0?n(".top-nav li:last").before(`<li>
                                                        <a class="nav-link text-white font-bold" id="IconNotification">
                                                            <i class="fa fa-bell text-warning"></i><sup style="top:-1.5em">${t.length}</sup>
                                                        </a>
                                                      </li>`):n("#IconNotification").closest("li").find("sup").text(t.length),n("#NotificationSection").length<1)n.when(n("body").append(`<div id="NotificationSection" class="position-fixed notification-div r-b"></div>`)).then(()=>{t.length>0&&(n("#NotificationSection").append(`<div class="markRead">
                                                                    <span class="form-control"><input type="checkbox" id="chkRead"> <label>Mark all as read</label></span>
                                                                  </div>`),n("#chkRead").click(t=>{n(t.currentTarget).is(":checked")&&n.post("/markallread").done(()=>{n("#NotificationSection").remove()})}));for(let i=0;i<t.length;i++){let r=t[i];n("#NotificationSection").append(`<div class="alert-dismissible p-2 mt-1 notification notification-${r.id}"  onmouseover="closeNotification('${r.id}', '${r.userID}','${r.entryDate}',true)">
                                                        <span class="float-right close" onclick="closeNotification('${r.id}', '${r.userID}','${r.entryDate}')">
                                                            <i class="fa fa-times"></i>
                                                        </span>
                                                        <strong class="alert-heading">${r.title}!</strong>                                                        
                                                        <div class="col-sm-12 text-center ${r.img===""?"d-none":""}">
                                                            <img src="/Image/Webnotification/${r.img}" style="height:250px;object-fit:cover"/>
                                                        </div>
                                                        <p style="font-family:cursive">${r.notification}<br/>
                                                            <small class="float-right"><i class="fa fa-clock pr-1"></i>${r.entryDate}</small></p>
                                                     </div>`)}});else{t.length>0&&(n("#NotificationSection").append(`<div class="markRead">
                                                                    <span class="form-control"><input type="checkbox" id="chkRead"> <label>Mark all as read</label></span>
                                                                  </div>`),n("#chkRead").click(t=>{n(t.currentTarget).is(":checked")&&n.post("/markallread").done(()=>{n("#NotificationSection").remove()})}));for(let i=0;i<t.length;i++){let r=t[i];n("#NotificationSection").append(`<div class="alert-dismissible p-2 mt-1 notification notification-${r.id}"  onmouseover="closeNotification('${r.id}', '${r.userID}','${r.entryDate}',true)">
                                                        <span class="float-right close" onclick="closeNotification('${r.id}', '${r.userID}','${r.entryDate}')">
                                                            <i class="fa fa-times"></i>
                                                        </span>
                                                        <strong class="alert-heading">${r.title}!</strong>                                                        
                                                        <div class="col-sm-12 text-center ${r.img===""?"d-none":""}">
                                                            <img src="/Image/Webnotification/${r.img}" style="height:250px;object-fit:cover"/>
                                                        </div>
                                                        <p style="font-family:cursive">${r.notification}<br/>
                                                            <small class="float-right"><i class="fa fa-clock pr-1"></i>${r.entryDate}</small></p>
                                                     </div>`)}}n("#IconNotification").click(t=>{if(i!==undefined&&i.length>0)if(n(t.currentTarget).parent("li").find("div").length>0)n(t.currentTarget).parent("li").find("div").remove();else{let r="";for(let n=0;n<i.length;n++){let t=i[n],u=i[n].isSeen?'<i class="fa fa-check-circle text-success"><\/i>':"";r+=`<li><strong>${t.title}</strong><p><span>${u}</span> ${t.notification}</br><small class="float-right"><i class="fa fa-clock pr-1"></i>${t.entryDate}</small></p></li>`}n(t.currentTarget).parent("li").append(`<div class="IconNotification"><ul>${r}</ul></div>`)}else n(t.currentTarget).parent("li").find("ul").length===0?r===!1&&(n.loadNotification(!0),r=!0):n(t.currentTarget).find("ul").remove()})}else n("#IconNotification").click()})};n.loadNotification(!1);setInterval(()=>n.loadNotification(!1),6e4)}})($);